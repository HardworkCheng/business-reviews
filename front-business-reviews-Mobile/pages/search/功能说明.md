# 搜索页面筛选排序功能说明

## ✅ 已完成的功能

### 📱 页面位置
**搜索页面** (`pages/search/search.vue`)
- 通过点击首页的分类图标（如🍜美食）进入
- 顶部显示：返回按钮 + 📍杭州 + 搜索框 + 👤头像
- 筛选栏位于搜索栏下方

---

## 🎯 功能详情

### 1. 🍜 分类下拉框

#### 触发方式
点击筛选栏中的"美食▼"按钮

#### 包含分类（8个）
```
🍜 美食        🎤 KTV
💇 丽人·美发    💅 美睫·美甲
💆 按摩·足疗    🛁 美容SPA
👶 亲子游乐     🍷 酒吧
```

#### 设计特点
- ✅ 2列网格布局
- ✅ 每个分类带emoji图标
- ✅ 当前选中项显示橙色背景（#FFF5ED）+ ✓标记
- ✅ 默认选中"美食"
- ✅ 从首页点击分类进入时，自动选中对应分类

#### 交互逻辑
- 点击分类项 → 关闭下拉框 → 显示Toast提示"已切换到XXX"
- 筛选栏按钮文字变为选中的分类名称
- 选中的分类按钮变为橙色背景

---

### 2. 📊 排序下拉框（4种）

#### 2.1 距离排序
**触发**：点击"距离▼"

**选项**：
- 从小到大（最近的店铺优先）
- 从大到小（最远的店铺优先）

**用途**：按店铺距离远近排序

---

#### 2.2 人气排序
**触发**：点击"人气▼"

**选项**：
- 从小到大（人气低→高）
- 从大到小（人气高→低）

**用途**：按店铺人气/浏览量排序

---

#### 2.3 评分排序
**触发**：点击"评分▼"

**选项**：
- 从小到大（低分→高分）
- 从大到小（高分→低分）

**用途**：按店铺评分高低排序

---

#### 2.4 价格排序
**触发**：点击"价格▼"

**选项**：
- 从小到大（便宜→贵）
- 从大到小（贵→便宜）

**用途**：按店铺人均价格排序

---

## 🎨 视觉设计

### 筛选栏样式
```scss
背景：#f5f5f5（普通）
选中：#FF9E64（橙色）
字体：26rpx
圆角：30rpx（胶囊形状）
```

### 下拉框样式
```scss
位置：position: absolute; top: 136rpx
背景：白色
阴影：0 4rpx 20rpx rgba(0, 0, 0, 0.1)
最大高度：500rpx（超出滚动）
```

### 颜色方案
| 状态 | 颜色 | 用途 |
|------|------|------|
| 普通按钮 | `#f5f5f5` | 未选中状态 |
| 激活按钮 | `#FF9E64` | 当前选中 |
| 选中项背景 | `#FFF5ED` | 浅橙色 |
| 文字 | `#333333` | 正常 |
| 勾选图标 | `#FF9E64` | ✓ |
| 遮罩层 | `rgba(0,0,0,0.3)` | 半透明 |

---

## 🎬 交互演示

### 场景1：选择分类

```
┌─────────────────────────────┐
│ ← 📍杭州 [🔍 美食]      👤  │
├─────────────────────────────┤
│ 美食△ 距离▼ 人气▼ 评分▼ 价格▼│  ← 箭头朝上
├─────────────────────────────┤
│ ┌─────────┬─────────┐      │
│ │🍜 美食 ✓│🎤 KTV   │      │  ← 2列网格
│ ├─────────┼─────────┤      │
│ │💇 丽人   │💅 美甲  │      │
│ ├─────────┼─────────┤      │
│ │💆 按摩   │🛁 SPA   │      │
│ ├─────────┼─────────┤      │
│ │👶 亲子   │🍷 酒吧  │      │
│ └─────────┴─────────┘      │
├─────────────────────────────┤
│ ████████████████████████    │  ← 遮罩层
└─────────────────────────────┘
```

**操作流程**：
1. 点击"美食▼" → 下拉框展开
2. 点击"KTV" → 关闭下拉框
3. 显示Toast："已切换到KTV"
4. 筛选栏变为：`KTV▼ 距离▼ 人气▼ 评分▼ 价格▼`

---

### 场景2：选择排序

```
┌─────────────────────────────┐
│ ← 📍杭州 [🔍 美食]      👤  │
├─────────────────────────────┤
│ 美食▼ 距离▼ 人气▼ 评分△ 价格▼│  ← 评分箭头朝上
├─────────────────────────────┤
│               ┌──────────┐  │
│               │从小到大  │  │
│               ├──────────┤  │
│               │从大到小✓ │  │  ← 高分优先
│               └──────────┘  │
└─────────────────────────────┘
```

**操作流程**：
1. 点击"评分▼" → 下拉框展开
2. 点击"从大到小" → 关闭下拉框
3. 显示Toast："按评分从大到小"
4. 店铺列表按评分从高到低排序

---

## 🔄 状态管理

```javascript
selectedCategory: '美食'     // 当前选中的分类
showCategoryDropdown: false  // 分类下拉框显示状态
showSortDropdown: null       // 排序下拉框显示状态
sortField: null              // 排序字段（distance/popularity/rating/price）
sortOrder: 'desc'            // 排序方向（asc/desc）
```

---

## 📋 互斥规则

### 同时只能打开一个下拉框
- ✅ 打开分类下拉 → 自动关闭排序下拉
- ✅ 打开排序下拉 → 自动关闭分类下拉
- ✅ 点击遮罩层 → 关闭所有下拉框
- ✅ 再次点击同一按钮 → 关闭当前下拉框

---

## 💡 使用场景

### 场景1：找最近的高分美食餐厅
```
1. 保持"美食"分类（默认）
2. 点击"评分▼" → 选择"从大到小"
3. 点击"距离▼" → 选择"从小到大"
✅ 结果：显示附近高分美食餐厅
```

### 场景2：找便宜的KTV
```
1. 点击"美食▼" → 选择"KTV"
2. 点击"价格▼" → 选择"从小到大"
✅ 结果：显示便宜的KTV，价格从低到高
```

### 场景3：找最火的酒吧
```
1. 点击"美食▼" → 选择"酒吧"
2. 点击"人气▼" → 选择"从大到小"
✅ 结果：显示人气最高的酒吧
```

---

## 🎯 待实现功能（TODO）

### 1. 分类筛选数据
```javascript
// 在 selectCategory() 中添加
const filteredShops = shopList.value.filter(shop => {
  return shop.category === selectedCategory.value
})
```

### 2. 排序功能
```javascript
// 在 selectSort() 中添加
shopList.value.sort((a, b) => {
  const field = sortField.value
  const order = sortOrder.value
  
  if (order === 'asc') {
    return a[field] - b[field]
  } else {
    return b[field] - a[field]
  }
})
```

### 3. 建议的店铺数据结构
```javascript
{
  id: 1,
  name: '蔡馬洪烤肉',
  category: '美食',          // 分类
  distance: 170.4,          // 距离（m）
  popularity: 1460,         // 人气（浏览量）
  rating: 4.6,             // 评分
  price: 85,               // 人均价格（元）
  // ... 其他字段
}
```

---

## 🎬 动画效果

### 下拉框展开
```css
@keyframes slideDown {
  from: 向上偏移20rpx + 透明
  to: 正常位置 + 不透明
  duration: 0.3s
}
```

### 箭头旋转
```css
普通：▼（0度）
展开：△（180度）
transition: 0.3s
```

### 遮罩层淡入
```css
@keyframes fadeIn {
  from: 完全透明
  to: 半透明遮罩
  duration: 0.3s
}
```

---

## 📊 布局结构

```
┌────────────────────────────┐
│ ← 📍杭州 [🔍 搜索框]  👤   │  ← 顶部搜索栏
├────────────────────────────┤
│ 美食▼ 距离▼ 人气▼ 评分▼ 价格▼│  ← 筛选栏（sticky）
├────────────────────────────┤
│ [下拉菜单区域]              │  ← 动态显示
├────────────────────────────┤
│ ┌─────────────────────┐   │
│ │ [图] 店铺1          │   │
│ │     ⭐4.6 (1460条)  │   │  ← 店铺列表
│ │     人均¥85 烤肉    │   │
│ └─────────────────────┘   │
│ ┌─────────────────────┐   │
│ │ [图] 店铺2          │   │
│ └─────────────────────┘   │
└────────────────────────────┘
```

---

## ✨ 优势总结

✅ **精准筛选**：8个分类 + 4种排序维度  
✅ **操作便捷**：一键切换，无需跳转页面  
✅ **视觉统一**：保持粘土乐园风格  
✅ **反馈清晰**：Toast提示 + 视觉高亮  
✅ **交互流畅**：0.3s动画 + 互斥逻辑  
✅ **空间高效**：下拉展开，节省空间

---

**搜索页面筛选排序功能完成！** 🎉
