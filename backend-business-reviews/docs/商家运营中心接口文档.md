# 商家运营中心接口文档

## 1. 认证与账号接口

### 1.1 商家登录
```
POST /merchant/auth/login
```

**请求参数：**
```json
{
  "phone": "13800138000",     // 手机号
  "password": "123456",       // 密码（密码登录时必填）
  "code": "123456"           // 验证码（验证码登录时必填）
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "商家名称",
      "phone": "13800138000",
      "avatar": "https://example.com/avatar.jpg",
      "merchantId": 1,
      "roles": ["admin"]
    }
  }
}
```

### 1.2 商家入驻注册
```
POST /merchant/auth/register
```

**请求参数：**
```json
{
  "phone": "13800138000",     // 手机号
  "code": "123456",           // 验证码
  "password": "123456",       // 密码
  "merchantName": "商家名称",   // 商家名称
  "contactName": "联系人姓名"   // 联系人姓名
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "商家名称",
      "phone": "13800138000",
      "avatar": "https://example.com/avatar.jpg",
      "merchantId": 1,
      "roles": ["admin"]
    }
  }
}
```

### 1.3 获取商家信息
```
GET /merchant/auth/profile
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "username": "商家名称",
    "phone": "13800138000",
    "avatar": "https://example.com/avatar.jpg",
    "merchantId": 1,
    "roles": ["admin"],
    "merchant": {
      "id": 1,
      "name": "商家名称",
      "contactPhone": "13800138000",
      "status": 1
    }
  }
}
```

### 1.4 发送验证码
```
POST /merchant/auth/send-code
```

**请求参数：**
```json
{
  "phone": "13800138000"     // 手机号
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

## 2. 门店管理接口

### 2.1 获取门店列表
```
GET /merchant/shops
```

**请求参数：**
```
?page=1&size=10&name=门店名称&status=1
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "name": "门店名称",
        "address": "门店地址",
        "phone": "010-12345678",
        "openingHours": "09:00-22:00",
        "description": "门店描述",
        "avatar": "https://example.com/avatar.jpg",
        "cover": "https://example.com/cover.jpg",
        "status": 1,
        "createdAt": "2023-01-01 12:00:00"
      }
    ],
    "total": 1
  }
}
```

### 2.2 创建门店
```
POST /merchant/shops
```

**请求参数：**
```json
{
  "name": "门店名称",
  "address": "门店地址",
  "phone": "010-12345678",
  "openingHours": "09:00-22:00",
  "description": "门店描述",
  "avatar": "https://example.com/avatar.jpg",
  "cover": "https://example.com/cover.jpg",
  "status": 1
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "name": "门店名称",
    "address": "门店地址",
    "phone": "010-12345678",
    "openingHours": "09:00-22:00",
    "description": "门店描述",
    "avatar": "https://example.com/avatar.jpg",
    "cover": "https://example.com/cover.jpg",
    "status": 1,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 2.3 更新门店
```
PUT /merchant/shops/{id}
```

**请求参数：**
```json
{
  "name": "门店名称",
  "address": "门店地址",
  "phone": "010-12345678",
  "openingHours": "09:00-22:00",
  "description": "门店描述",
  "avatar": "https://example.com/avatar.jpg",
  "cover": "https://example.com/cover.jpg",
  "status": 1
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "name": "门店名称",
    "address": "门店地址",
    "phone": "010-12345678",
    "openingHours": "09:00-22:00",
    "description": "门店描述",
    "avatar": "https://example.com/avatar.jpg",
    "cover": "https://example.com/cover.jpg",
    "status": 1,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 2.4 获取门店详情
```
GET /merchant/shops/{id}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "name": "门店名称",
    "address": "门店地址",
    "phone": "010-12345678",
    "openingHours": "09:00-22:00",
    "description": "门店描述",
    "avatar": "https://example.com/avatar.jpg",
    "cover": "https://example.com/cover.jpg",
    "status": 1,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

## 3. 优惠券管理接口

### 3.1 获取优惠券列表
```
GET /merchant/coupons
```

**请求参数：**
```
?page=1&size=10&title=优惠券名称&type=1&status=1
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "merchantId": 1,
        "title": "优惠券名称",
        "type": 1,
        "amount": 10,
        "threshold": 100,
        "totalCount": 1000,
        "remainCount": 900,
        "perUserLimit": 1,
        "startTime": "2023-01-01 00:00:00",
        "endTime": "2023-12-31 23:59:59",
        "status": 1,
        "createdAt": "2023-01-01 12:00:00"
      }
    ],
    "total": 1
  }
}
```

### 3.2 创建优惠券
```
POST /merchant/coupons
```

**请求参数：**
```json
{
  "title": "优惠券名称",
  "type": 1,
  "amount": 10,
  "threshold": 100,
  "totalCount": 1000,
  "perUserLimit": 1,
  "startTime": "2023-01-01 00:00:00",
  "endTime": "2023-12-31 23:59:59",
  "stackable": false,
  "applicableShops": [1, 2],
  "description": "优惠券描述"
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "merchantId": 1,
    "title": "优惠券名称",
    "type": 1,
    "amount": 10,
    "threshold": 100,
    "totalCount": 1000,
    "remainCount": 1000,
    "perUserLimit": 1,
    "startTime": "2023-01-01 00:00:00",
    "endTime": "2023-12-31 23:59:59",
    "status": 0,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 3.3 更新优惠券
```
PUT /merchant/coupons/{id}
```

**请求参数：**
```json
{
  "title": "优惠券名称",
  "type": 1,
  "amount": 10,
  "threshold": 100,
  "totalCount": 1000,
  "perUserLimit": 1,
  "startTime": "2023-01-01 00:00:00",
  "endTime": "2023-12-31 23:59:59",
  "stackable": false,
  "applicableShops": [1, 2],
  "description": "优惠券描述"
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "merchantId": 1,
    "title": "优惠券名称",
    "type": 1,
    "amount": 10,
    "threshold": 100,
    "totalCount": 1000,
    "remainCount": 1000,
    "perUserLimit": 1,
    "startTime": "2023-01-01 00:00:00",
    "endTime": "2023-12-31 23:59:59",
    "status": 0,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 3.4 获取优惠券详情
```
GET /merchant/coupons/{id}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "merchantId": 1,
    "title": "优惠券名称",
    "type": 1,
    "amount": 10,
    "threshold": 100,
    "totalCount": 1000,
    "remainCount": 900,
    "perUserLimit": 1,
    "startTime": "2023-01-01 00:00:00",
    "endTime": "2023-12-31 23:59:59",
    "status": 1,
    "applicableShops": [1, 2],
    "description": "优惠券描述",
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 3.5 发放优惠券
```
POST /merchant/coupons/{id}/issue
```

**请求参数：**
```json
{
  "totalCount": 1000
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

### 3.6 核销优惠券
```
POST /merchant/coupons/{id}/redeem
```

**请求参数：**
```json
{
  "code": "COUPON123456"     // 优惠券码
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

## 4. 笔记管理接口

### 4.1 获取笔记列表
```
GET /merchant/notes
```

**请求参数：**
```
?page=1&size=10&title=笔记标题&status=2&shopId=1
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "title": "笔记标题",
        "content": "笔记内容",
        "shopId": 1,
        "shopName": "门店名称",
        "images": ["https://example.com/image1.jpg"],
        "tags": ["标签1", "标签2"],
        "views": 100,
        "likes": 50,
        "comments": 10,
        "status": 2,
        "createdAt": "2023-01-01 12:00:00"
      }
    ],
    "total": 1
  }
}
```

### 4.2 创建笔记
```
POST /merchant/notes
```

**请求参数：**
```json
{
  "title": "笔记标题",
  "content": "笔记内容",
  "shopId": 1,
  "images": ["https://example.com/image1.jpg"],
  "tags": ["标签1", "标签2"],
  "publishTime": "2023-01-01 12:00:00",
  "status": 0
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "title": "笔记标题",
    "content": "笔记内容",
    "shopId": 1,
    "shopName": "门店名称",
    "images": ["https://example.com/image1.jpg"],
    "tags": ["标签1", "标签2"],
    "views": 0,
    "likes": 0,
    "comments": 0,
    "status": 0,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 4.3 更新笔记
```
PUT /merchant/notes/{id}
```

**请求参数：**
```json
{
  "title": "笔记标题",
  "content": "笔记内容",
  "shopId": 1,
  "images": ["https://example.com/image1.jpg"],
  "tags": ["标签1", "标签2"],
  "publishTime": "2023-01-01 12:00:00",
  "status": 0
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "title": "笔记标题",
    "content": "笔记内容",
    "shopId": 1,
    "shopName": "门店名称",
    "images": ["https://example.com/image1.jpg"],
    "tags": ["标签1", "标签2"],
    "views": 0,
    "likes": 0,
    "comments": 0,
    "status": 0,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 4.4 获取笔记详情
```
GET /merchant/notes/{id}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": 1,
    "title": "笔记标题",
    "content": "笔记内容",
    "shopId": 1,
    "shopName": "门店名称",
    "images": ["https://example.com/image1.jpg"],
    "tags": ["标签1", "标签2"],
    "views": 100,
    "likes": 50,
    "comments": 10,
    "status": 2,
    "createdAt": "2023-01-01 12:00:00"
  }
}
```

### 4.5 发布笔记
```
POST /merchant/notes/{id}/publish
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

### 4.6 下线笔记
```
POST /merchant/notes/{id}/offline
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

## 5. 评论管理接口

### 5.1 获取评论列表
```
GET /merchant/comments
```

**请求参数：**
```
?page=1&size=10&content=评论内容&status=1
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "userId": 1,
        "userName": "用户名",
        "content": "评论内容",
        "targetType": 1,
        "targetId": 1,
        "targetTitle": "笔记标题",
        "status": 1,
        "createdAt": "2023-01-01 12:00:00"
      }
    ],
    "total": 1
  }
}
```

### 5.2 回复评论
```
POST /merchant/comments/{id}/reply
```

**请求参数：**
```json
{
  "content": "回复内容"
}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

### 5.3 删除评论
```
DELETE /merchant/comments/{id}
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": null
}
```

## 6. 数据看板接口

### 6.1 获取数据看板数据
```
GET /merchant/dashboard
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "todayViews": 1000,
    "todayInteractions": 200,
    "todayCouponsClaimed": 50,
    "todayCouponsRedeemed": 30,
    "viewGrowth": 10.5,
    "interactionGrowth": 5.2,
    "couponGrowth": 15.3,
    "redeemGrowth": 8.7,
    "viewTrend": [
      {"date": "2023-01-01", "views": 100},
      {"date": "2023-01-02", "views": 120}
    ],
    "topNotes": [
      {"title": "笔记标题", "views": 100, "interactions": 50}
    ]
  }
}
```

### 6.2 获取笔记分析数据
```
GET /merchant/analytics/notes
```

**请求参数：**
```
?startDate=2023-01-01&endDate=2023-01-31
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "totalViews": 10000,
    "totalLikes": 2000,
    "totalComments": 500,
    "topNotes": [
      {"title": "笔记标题", "views": 1000, "likes": 200, "comments": 50}
    ]
  }
}
```

### 6.3 获取优惠券分析数据
```
GET /merchant/analytics/coupons
```

**请求参数：**
```
?startDate=2023-01-01&endDate=2023-01-31
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "totalIssued": 1000,
    "totalClaimed": 800,
    "totalRedeemed": 600,
    "topCoupons": [
      {"title": "优惠券名称", "issued": 100, "claimed": 80, "redeemed": 60}
    ]
  }
}
```

### 6.4 获取用户分析数据
```
GET /merchant/analytics/users
```

**请求参数：**
```
?startDate=2023-01-01&endDate=2023-01-31
```

**响应数据：**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "totalUsers": 10000,
    "newUsers": 1000,
    "activeUsers": 5000,
    "userGrowth": 10.5
  }
}
```